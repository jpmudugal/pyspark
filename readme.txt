Changing code to optimise and make compatible with Spark3.  Making amendments for practice.