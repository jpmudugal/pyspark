learining git for good 

updated code to be compatible with spark3